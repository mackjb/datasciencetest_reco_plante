<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Slides — ExtraTrees PlantVillage v2</title>
  <link rel="preconnect" href="https://remarkjs.com" crossorigin>
  <style>
    :root { color-scheme: light dark; }
    .remark-slide-content { font-size: 28px; }
    code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
  </style>
</head>
<body>
  <textarea id="source" style="display:none">
---
marp: true
paginate: true
style: |
  section { font-size: 28px; }
---

# ExtraTrees PlantVillage v2

- Pipeline robuste + traçabilité
- Dataset: PlantVillage (features extraites)
- Auteur: Cascade • Date: 2025-08-22

---

## Objectif & Données

- Objectif: ExtraTrees performant et interprétable, bonnes pratiques ML
- Données: `clean_with_features_data_plantvillage_segmented_all.csv`
  - 6 871 lignes • 42 features num • 14 classes
  - Nettoyage: drop NA sur cible, exclure `is_na`/doublons si présents

---

## Pipeline (prétraitement)

- Numériques: Imputation médiane + Winsorizer (1–99%)
- Catégorielles: OHE `handle_unknown="ignore"` (pas de cat ici mais supporté)
- Pas de scaling: arbres invariants à l’échelle

---

## Déséquilibre & Validation

- Déséquilibre: comparer `class_weight ∈ {None, "balanced"}` vs `RandomOverSampler`
  - Ne pas cumuler `class_weight` + oversampling
- Validation: CV 5-fold stratifiée + split stratifié
- Scoring: `f1_macro` (refit) + `balanced_accuracy`

---

## Grille & Ressources

- Grille (24 cand.): `n_estimators {200,400}`, `min_samples_split {2,5}`, `min_samples_leaf {1,2}`
  - `max_features="sqrt"`, `bootstrap=False`, `criterion="gini"`, `sampler {passthrough, ROS}`
- Ressources: `N_JOBS_ESTIMATOR` (threads ExtraTrees), `N_JOBS_OUTER` (CV)

---

## Résultats principaux

- Baseline CV (mean): bal.acc ≈ 0.7662 • F1-macro ≈ 0.7625
- Meilleurs hyperparams:
```json
{"sampler":"passthrough","model__class_weight":null,
 "model__n_estimators":400,"model__max_features":"sqrt",
 "model__min_samples_split":2,"model__min_samples_leaf":1,
 "model__criterion":"gini","model__bootstrap":false,"model__max_depth":null}
```
- Test: bal.acc = 0.7676 • F1-macro = 0.7659

---

## Interprétabilité

- Top features: `std_B`, `mean_B`, `mean_H`, `std_G`, `mean_R`, `contrast`, ...
- Fichiers: `feature_importances.csv`
- SHAP: optionnel via `ENABLE_SHAP=1`

---

## Artefacts clés

- `results/models/extratrees_plantvillage_v2/`
  - `cv_baseline_scores.csv`, `gridsearch_results.csv`, `best_params.json`
  - `evaluation/{classification_report.txt, confusion_matrix.csv, predictions_test.csv}`
  - `feature_importances.csv`, `plots/*.html`
  - `grid_trials.jsonl` (tous les essais)

---

## Pistes d'amélioration

- Étendre la grille: `criterion {gini, entropy}`, `ccp_alpha`, `min_impurity_decrease`
- Tester RUS/SMOTE (SMOTENC si cat.)
- Ajouter `f1_micro`/`f1_weighted` en suivi complémentaire
- Activer SHAP (diagnostic global/local)
- Seeds multiples / CV répétée pour robustesse
  </textarea>

  <script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
  <script>
    const slideshow = remark.create({
      ratio: '16:9',
      navigation: { click: true },
      highlightStyle: 'github',
    });
  </script>
</body>
</html>
